# CPU (Central Processing Unit)

## Введение

Данный проект содержит три программы: ```assembler```, ```disassembler``` и ```processor```.

## Скачивание и установка проекта

Для установки проекта используется утилита `git`.

```CMake
    git clone git@github.com:ksshkh/CPU.git
```
Каждая из программ собирается с помощью утилиты `make`.

```CMake
    make
```

## Assembler

Программа переводит код, написанный на ассемблере, в машинный и записывает его в файл ```result.bin```.
При запуске программы вводится название файла с кодом на ассемблере, например:

```Bash
    ./asm ../programs/factorial.txt
```

Если название файла указано не будет, по умолчанию будет открыт файл ```program.txt```.

### Команды, которые распознаёт ассемблер (и выполняет сам процессор)

1. hlt    - завершение программы
2. dump   - печать информации о текущем состоянии стека
3. push   - добавление числа в стек
4. pop    - удаление числа из стека
5. out    - вывод последнего числа из стека
6. in     - запрашивает ввод и добавляет полученное значение в стек
7. add    - сложение
8. sub    - вычитание
9. mul    - умножение
10. div   - деление
11. sqrt  - квадратный корень
12. sin   - синус
13. cos   - косинус
14. jmp (ja, jae, jb, jbe, je, jne) - различные прыжки
15. call  - вызов функции
16. ret   - возврат из функции
17. draw  - выводит на экран оперативную память в текущем состоянии в виде квадрата размером n*n (если такое возможно),
где n - последнее число в стеке
18. cout  - вывод последнего числа из стека в формате символа

Для обращения к оперативной памяти используются квадратные скобки.
Например, команда ```push[ax + 5]``` означает, что в стек "пушится" число из ячейки оперативной
памяти с номером, равной сумме числа из регистра ```ax``` и цифры 5.

Примеры программ находятся в папке ```programs```.

## Disassembler

Эта программа, наоборот, переводит машинный код из файла ```result.bin``` в код на ассемблере.
Результат - файл ```retranslation.txt```.

## Processor

### Состовляющие процессора:

* Стек
* 4 регистра: ```ax```, ```bx```, ```cx```, ```dx```
* Оперативная память

В стеке последовательно выполняются все команды из полученного процессором бинарного файла ```result.bin```.

> [!NOTE]
>
> Проект поддерживает только целочисленный тип данных

## Debug

В папке ```debug``` находится log-файл ассемблера ```assembler_dump.log``` (содержит таблицу команд и таблицу меток) и
файл ```processor_dump.txt```, в котором видно состояние всего процессора после выполнения каждой инструкции,
что очень помогает при отладке.

